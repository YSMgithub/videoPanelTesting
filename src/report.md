# Тестирование мультимодема Sistematics


## Этапы тестирования

1. [Условия тестеривания](#условия-тестирования)
2. [Тесирование видеопанели Beward SM400W прямая связанность](#тестирование-beward-sm400w) \
   2.1. [Сетевые настройки видеопанели sm400w](#сетевые-настройки-видеопанели) \
   2.2. [Тестирование работы с beward 20211](#тестирование-с-beward-20211)  
   2.3. [Маршрутизация при потере одно из каналов](#потеря-канала) \
   2.4. [Потеря наземного канала](#потеря-наземного-канала) \
   2.5. [Тест загрузки процессора](#тест-загрузки-процессора) \
   2.6. [IP адресация](#ip-адресация) 
3. [Итоги тестирования](#итоги-тестирования)
4. [Возможные варианты использования](#варианты-использования)

## Условия тестирования

Мульти модем (далее ММ) расположен на столе в центре офиса, в трех метрах от 


## Тестирование beward sm400w
Тестируем возможные режимы работы видеопанели Beward SM400w с многоабонентскими вызывными панелями Beward 20211 и Rubitek "vpisat' model'". Тестируем возможность вывода изображения с IP камер видеонаблюдения на видеопанель. 

### Сетевые настройки видеопанели


Видеопанель находится в одной локальной сети с вызывными панелям. Видеопанель имеет Web интерфейс по умолчанию на ней включено DHCP и имеется fallback ip адрес, на случай отсутсвия DHCP сервера. По умолчанию он 192.168.0.99.  

- Страница логина в веб интерфейс вызывной панели.

<img src="../img/beward_sm400w_login.png" alt="login"/>

Логин и пароль по умолчанию: admin admin. Логинимся:


- Главная страница веб интерфейса.

<img src="../img/beward_sm400w_main.png" alt="main"/>

В пункте меню сеть настраиваем статический ip адресс, в нашем случае 192.168.0.101.

- Сетевые настройки.

<img src="../img/beward_sm400w_network.png" alt="network"/>


### Тестирование с beward 20211

Beward в своих системах использует ничем не модифицированный протокол SIP 2.0. Для подключения абонентской видеопанели не требуется сип сервер. Необходимо чтобы один из сип аккаунтов на вызывной панели был пустой, но активированный. На видеопанели никаках настроек кроме настройки ip адреса не требуется. Опишем процесс настройки вызывной панели и видеопанели:

- Заходим в веб интерфейс вызывной панели по IP адресу.

<img src="../img/beward_20211_main.png" alt="main"/>

- Переходим в меню Сеть->LAN. Проверяем есть ли сетевая связанность с видеопанелью. Для этого в окне "проверить адрес" вводим айпи адрес виеопанели и нажимаем PING

<img src="../img/beward_20211_lan.png" alt="lann"/>

Пинг должен проходить, если нет тогда необходимо проверить сетевые настройки видеопанили и вызывной панели и убидиться что они находятся внутри одной локальной сети.

- Переходим в меню SIP. В нем есть настройки двух SIP аккаунтов. Один из них будет настроен на соединение с сервером Росдомофона, второй должен быть пустой. Его необходимо активировать при помощи галочки в соотвествующем чекбоксе и указать номер в пункте номер, произвольное число, но не должено совпадать с номерами квартир. Пример настройки:

<img src="../img/beward_20211_sip.png" alt="sip"/>

- Далее необходимо в настройках вызывной панели настроить связанность номера квартиры с ip адресом видеопанели установленной в ней. Для этого переходим в меню Домофон->Квартиры. В этом меню ищем настройки квартиры, в которую была установлена видеопанель, в пункте поиск указываем необходимый номер квартиры и нажимаем поиск. Активируем пункт номера для вызова и прописываем в первом ip адрес и сип порт нашей видеопанели. Порт по умалчанию 5060. Пример заполнения:

<img src="../img/beward_20211_flat.png" alt="flat"/>

Если все сделано правильно должен пойти сип вызов на видеопанель. Если вызов не идет проверяем все настройки.

- Настройка кнопки открывания дверей. Открытие дверей осуществляется отправкой тонального сигнала (DTMF) внутри сип сессии. Для начала необходимо определить к какой цифре привязано открытие дверей на вызывной панели. Для этого необходимо зайти в меню SIP->дополнительно на вызывной панели. Там будет указана цифра привязанная к открытию основной двери, запомним ее.

<img src="../img/beward_20211_dtmf.png" alt="dtmf"/>

- Настройка кнопки на видеопанели. На видеопанели beward sm400w по умолчанию не настроены физичесие кнопки. Настроим кнопку открывания дверей. Для этого заходим в вебинтерфейс видеопанели по айпи адресу. Там выбираем пункт меню Клавиши. В данном меню есть настройки трех физичиских клавиш видеопанели. Клавиша DSS1 соответсвует кнопке с изображением консъержа, DSS2 - кнопке с изображением видеокамеры, DSS3 - кнопке с изабраженим ключа. Настроим кнопку с изображением ключа DSS3. Поле "тип" выбираем DTMF, поле имя - произвольное значение, значение указываем - ту цифру, которую мы запомнили в предыдущем пункте. Пример на скриншоте:

<img src="../img/beward_sm400w_key.png" alt="key"/>

Проверяем функционирование кнопки открытия дверей. Она будет функционировать только при вызове. 

- Получение видео с домофона по нажатию физичечкой кнопки. Как мы уже знаем, по умолчанию на видеопанели Beward sm400w кнопки не настроены. Для настройки отображения камер на видеопанели по нажатию кнопки необходимо зайти в меню "Клавиши". Получение видеопотока с камер наблюдения возможно по RTSP потоку. В меню "клавиши" есть отдельная вкладка "дополнительно" и там отображаются камеры обнаруженные в локальной сети, но подключить камеру при помощи этого меню не получилось. Тех. поддержка дала комментарий что этот функционал полностью не оттестирован и советую заводить камеры по RTSP. Как выяснилось опытном путем не всякий RTSP поток способна потянуть видеопанель. Если в панели домофона в меню кодирование оставить профайл HIGH то поток не отображается, при изминении профайла на  BASELINE видео начинает отобржаться. Пример настройки вызывной панели Beward:

<img src="../img/beward_20211_video.png" alt="video"/>

- Настроим саму видеопанель. Для этого заходим в веб интерфейс видеопанели и переходим во вкладку "Клавиши". Тут необходимо настроить конфигурацию клавиши. Выбираем Тип -> URL	Имя -> произвольное название	Значение -> rtsp ссылка (в случае с вызывной панелью Beward она имеет следующий вид: rtsp://"логин":"пароль"@"ай-пи адрес панели":554/av0_0)		Подтип -> IP камера. Пример заполения:

<img src="../img/beward_sm400w_video.png" alt="video"/>

- На этом закончим настройку вызывной панели. Естественно необходимо поменять пароли, не оставлять стандартные, и выставить время. Меню "Настройки" вкладка "Время/дата"

<img src="../img/beward_sm400w_date.png" alt="date"/>
